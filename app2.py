import streamlit as st

# -----------------------------
# í˜ì´ì§€ ì„¤ì •
# -----------------------------
st.set_page_config(
    page_title="ğŸ§ª ìŠ¤ë§ˆíŠ¸ í•©ê¸ˆ ì„¤ê³„ ì‹œë®¬ë ˆì´í„° âš™ï¸",
    page_icon="âš™ï¸",
    layout="centered"
)

st.title("ğŸ§ª ìŠ¤ë§ˆíŠ¸ í•©ê¸ˆ ì„¤ê³„ ì‹œë®¬ë ˆì´í„° âš™ï¸")
st.write("ì›ì†Œ íŠ¹ì§•ê³¼ í•©ê¸ˆ ì¡°í•©, ì‹¤ì œ í™œìš© ë¶„ì•¼ê¹Œì§€ í™•ì¸í•´ë³´ì„¸ìš”! âœ¨")

# -----------------------------
# ì›ì†Œ íŠ¹ì§• ë°ì´í„°
# -----------------------------
elements = {
    "ì² (Fe)": "ğŸ’ª ê°•ë„ ë†’ìŒ(ì™¸ë¶€ í˜ì— ê°•í•¨), ğŸ”¥ ë‚´ì—´ì„± ìˆìŒ(ê³ ì˜¨ì—ì„œë„ ì•ˆì •), âš–ï¸ ë¬´ê±°ì›€",
    "íƒ„ì†Œ(C)": "ğŸ—ï¸ ê°•ë„ë¥¼ ì¦ê°€ì‹œí‚¤ëŠ” ì²¨ê°€ë¬¼(ê°•ì²  ê°•í™”), ğŸ”¹ ê²½ëŸ‰, âš¡ ê²½ë„â†‘(ë‹¨ë‹¨í•¨)",
    "ì•Œë£¨ë¯¸ëŠ„(Al)": "âš–ï¸ ê°€ë²¼ì›€, ğŸ›¡ï¸ ë‚´ì‹ì„± ì¢‹ìŒ(ë¶€ì‹ì— ê°•í•¨), âœˆï¸ í•­ê³µìš©",
    "êµ¬ë¦¬(Cu)": "âš¡ ì „ê¸°ì „ë„ì„± ìš°ìˆ˜, ğŸ›¡ï¸ ë‚´ì‹ì„±(ë¶€ì‹ ë°©ì§€), ğŸ”¶ ì¤‘ê°„ ë¬´ê²Œ",
    "ë‹ˆì¼ˆ(Ni)": "ğŸ›¡ï¸ ë‚´ì‹ì„±(ë¶€ì‹ ë°©ì§€), ğŸ”¥ ë‚´ì—´ì„±(ê³ ì˜¨ ì•ˆì •), ğŸ’ª ê°•ë„ ì¤‘ê°„"
}

# -----------------------------
# ğŸ” ì›ì†Œ íƒêµ¬ (íŠ¹ì§• ì¶œë ¥ ê¸°ëŠ¥)
# -----------------------------
st.subheader("ğŸ” ì›ì†Œ íƒêµ¬")
selected_element = st.selectbox("íŠ¹ì§•ì„ ì•Œê³  ì‹¶ì€ ì›ì†Œë¥¼ ì„ íƒí•˜ì„¸ìš”:", list(elements.keys()))
st.write(f"âœ¨ {selected_element} ì˜ íŠ¹ì§•: {elements[selected_element]}")

# -----------------------------
# ì›ì†Œ ì„ íƒ
# -----------------------------
st.subheader("ğŸ§¬ ì›ì†Œ ì„ íƒ ë° ë¹„ìœ¨ ì„¤ì •")
metal1 = st.selectbox("ì›ì†Œ 1 ğŸ”¹", list(elements.keys()))
ratio1 = st.slider("ë¹„ìœ¨ (%) ğŸ”¹", 0, 100, 50)

metal2 = st.selectbox("ì›ì†Œ 2 ğŸ”¸", list(elements.keys()))
ratio2 = st.slider("ë¹„ìœ¨ (%) ğŸ”¸", 0, 100, 50)

# -----------------------------
# ì›ì†Œ íŠ¹ì§• ì¶œë ¥
# -----------------------------
st.subheader("ğŸ“ ì„ íƒí•œ ì›ì†Œ íŠ¹ì§•")
st.write(f"ğŸ”¹ {metal1}: {elements[metal1]}")
st.write(f"ğŸ”¸ {metal2}: {elements[metal2]}")

# -----------------------------
# í•©ê¸ˆ ê³„ì‚° í•¨ìˆ˜
# -----------------------------
def calc_properties(m1, r1, m2, r2):
    score = {
        "ğŸ’ª ê°•ë„": 0,
        "ğŸ›¡ï¸ ë‚´ì‹ì„±": 0,
        "âš–ï¸ ê°€ë²¼ì›€": 0
    }
    factor = {
        "ì² (Fe)": {"strength": 0.6, "corrosion": 0.2, "weight": 0.2},
        "íƒ„ì†Œ(C)": {"strength": 0.3, "corrosion": 0.1, "weight": 0.3},
        "ì•Œë£¨ë¯¸ëŠ„(Al)": {"strength": 0.4, "corrosion": 0.5, "weight": 0.7},
        "êµ¬ë¦¬(Cu)": {"strength": 0.3, "corrosion": 0.4, "weight": 0.3},
        "ë‹ˆì¼ˆ(Ni)": {"strength": 0.5, "corrosion": 0.6, "weight": 0.3}
    }
    total = r1 + r2
    score["ğŸ’ª ê°•ë„"] = (factor[m1]["strength"]*r1 + factor[m2]["strength"]*r2)/total*100
    score["ğŸ›¡ï¸ ë‚´ì‹ì„±"] = (factor[m1]["corrosion"]*r1 + factor[m2]["corrosion"]*r2)/total*100
    score["âš–ï¸ ê°€ë²¼ì›€"] = (factor[m1]["weight"]*r1 + factor[m2]["weight"]*r2)/total*100
    return score

# -----------------------------
# ì‹¤ì œ í•©ê¸ˆê³¼ í™œìš© ë¶„ì•¼
# -----------------------------
alloy_info = {
    ("ì² (Fe)", "íƒ„ì†Œ(C)"): ("ê°•ì² ", "ğŸ—ï¸ ê±´ì¶• êµ¬ì¡°ì¬, ğŸ”© ê¸°ê³„ë¶€í’ˆ"),
    ("ì•Œë£¨ë¯¸ëŠ„(Al)", "êµ¬ë¦¬(Cu)"): ("ì•Œë£¨ë¯¸ëŠ„-êµ¬ë¦¬ í•©ê¸ˆ", "âœˆï¸ í•­ê³µ, ğŸš— ìë™ì°¨ ë¶€í’ˆ"),
    ("ì² (Fe)", "ë‹ˆì¼ˆ(Ni)"): ("ìŠ¤í…Œì¸ë¦¬ìŠ¤ê°•", "ğŸ—ï¸ ê±´ì¶•, ğŸ´ ì£¼ë°©ìš©í’ˆ"),
    ("ì•Œë£¨ë¯¸ëŠ„(Al)", "ë‹ˆì¼ˆ(Ni)"): ("ì•Œë£¨ë¯¸ëŠ„-ë‹ˆì¼ˆ í•©ê¸ˆ", "ğŸš€ í•­ê³µ, âš™ï¸ ê¸°ê³„ ë¶€í’ˆ"),
    ("êµ¬ë¦¬(Cu)", "ë‹ˆì¼ˆ(Ni)"): ("ë¸Œë¼ìŠ¤(í™©ë™)", "ğŸ’¡ ì „ê¸°, ì¥ì‹ êµ¬, ë°°ê´€")
}

def get_alloy_info(m1, m2):
    key = (m1, m2)
    key_rev = (m2, m1)
    if key in alloy_info:
        return alloy_info[key]
    elif key_rev in alloy_info:
        return alloy_info[key_rev]
    else:
        return ("ì‚¬ìš©ì ì •ì˜ í•©ê¸ˆ", "ğŸ”¬ ì‹¤í—˜ì  í•©ê¸ˆ, ë‹¤ì–‘í•œ ì‚°ì—… ë¶„ì•¼ì—ì„œ ì—°êµ¬ì¤‘")

# -----------------------------
# í•©ê³„ ì²´í¬ ë° ê²°ê³¼ ì¶œë ¥
# -----------------------------
if ratio1 + ratio2 != 100:
    st.warning("âš ï¸ ë¹„ìœ¨ í•©ê³„ê°€ 100%ê°€ ë˜ë„ë¡ ì¡°ì •í•´ì£¼ì„¸ìš”!")
else:
    st.success("âœ… ë¹„ìœ¨ í•©ê³„ 100%")
    scores = calc_properties(metal1, ratio1, metal2, ratio2)

    st.subheader("ğŸ“Š í•©ê¸ˆ ì˜ˆì¸¡ ê²°ê³¼")
    st.write(f"ğŸ”¹ í•©ê¸ˆ ì¡°í•©: {metal1} {ratio1}% + {metal2} {ratio2}%")
    st.write(f"ğŸ’ª ê°•ë„: {scores['ğŸ’ª ê°•ë„']:.1f} / 100")
    st.write(f"ğŸ›¡ï¸ ë‚´ì‹ì„±: {scores['ğŸ›¡ï¸ ë‚´ì‹ì„±']:.1f} / 100")
    st.write(f"âš–ï¸ ê°€ë²¼ì›€: {scores['âš–ï¸ ê°€ë²¼ì›€']:.1f} / 100")

    # -----------------------------
    # ğŸ“ˆ ê·¸ë˜í”„ (xì¶• ì´ë¦„ + yì¶• ê°’)
    # -----------------------------
    st.subheader("ğŸ“ˆ íŠ¹ì„± ê·¸ë˜í”„")
    chart_data = {
        "íŠ¹ì„±": list(scores.keys()),
        "ê°’": list(scores.values())
    }
    st.bar_chart(data=chart_data, x="íŠ¹ì„±", y="ê°’", height=300)

    # -----------------------------
    # ì‹¤ì œ í•©ê¸ˆ ì´ë¦„ê³¼ í™œìš© ë¶„ì•¼
    # -----------------------------
    st.subheader("ğŸ­ ì‹¤ì œ í•©ê¸ˆ ë° í™œìš© ë¶„ì•¼")
    alloy_name, application = get_alloy_info(metal1, metal2)
    st.write(f"ğŸ”¹ í•©ê¸ˆ ì´ë¦„: **{alloy_name}**")
    st.write(f"ğŸ”¹ í™œìš© ë¶„ì•¼: {application}")
