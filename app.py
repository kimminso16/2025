import streamlit as st

# -----------------------------
# í˜ì´ì§€ ì„¤ì •
# -----------------------------
st.set_page_config(
    page_title="ğŸ§ª ìŠ¤ë§ˆíŠ¸ í•©ê¸ˆ ì„¤ê³„ ì‹œë®¬ë ˆì´í„° âš™ï¸",
    page_icon="âš™ï¸",
    layout="centered"
)

st.title("ğŸ§ª ìŠ¤ë§ˆíŠ¸ í•©ê¸ˆ ì„¤ê³„ ì‹œë®¬ë ˆì´í„° âš™ï¸")
st.write("ì›ì†Œ íŠ¹ì§•ì„ í™•ì¸í•˜ê³ , í•©ê¸ˆì„ ë§Œë“¤ì–´ íŠ¹ì„±ê³¼ í™œìš© ë¶„ì•¼ë¥¼ ì˜ˆì¸¡í•´ë³´ì„¸ìš”! âœ¨")

# -----------------------------
# ì›ì†Œ íŠ¹ì§• ë°ì´í„°
# -----------------------------
elements = {
    "ì² (Fe)":"ğŸ’ª ê°•ë„ ë†’ìŒ, ğŸ”¥ ë‚´ì—´ì„± ìˆìŒ, âš–ï¸ ë¬´ê±°ì›€",
    "íƒ„ì†Œ(C)":"ğŸ—ï¸ ê°•ë„ë¥¼ ì¦ê°€ì‹œí‚¤ëŠ” ì²¨ê°€ë¬¼, ğŸ”¹ ê²½ëŸ‰, âš¡ ê²½ë„â†‘",
    "ì•Œë£¨ë¯¸ëŠ„(Al)":"âš–ï¸ ê°€ë²¼ì›€, ğŸ›¡ï¸ ë‚´ì‹ì„± ì¢‹ìŒ, âœˆï¸ í•­ê³µìš©",
    "êµ¬ë¦¬(Cu)":"âš¡ ì „ê¸°ì „ë„ì„± ìš°ìˆ˜, ğŸ›¡ï¸ ë‚´ì‹ì„±, ğŸ”¶ ì¤‘ê°„ ë¬´ê²Œ",
    "ë‹ˆì¼ˆ(Ni)":"ğŸ›¡ï¸ ë‚´ì‹ì„±, ğŸ”¥ ë‚´ì—´ì„±, ğŸ’ª ê°•ë„ ì¤‘ê°„"
}

# -----------------------------
# ì›ì†Œ ì„ íƒ
# -----------------------------
st.subheader("ğŸ§¬ ì›ì†Œ ì„ íƒ ë° ë¹„ìœ¨ ì„¤ì •")

metal1 = st.selectbox("ì›ì†Œ 1 ğŸ”¹", list(elements.keys()))
ratio1 = st.slider("ë¹„ìœ¨ (%) ğŸ”¹", 0, 100, 50)

metal2 = st.selectbox("ì›ì†Œ 2 ğŸ”¸", list(elements.keys()))
ratio2 = st.slider("ë¹„ìœ¨ (%) ğŸ”¸", 0, 100, 50)

# -----------------------------
# ì›ì†Œ íŠ¹ì§• ì¶œë ¥
# -----------------------------
st.subheader("ğŸ“ ì„ íƒí•œ ì›ì†Œ íŠ¹ì§•")
st.write(f"ğŸ”¹ {metal1}: {elements[metal1]}")
st.write(f"ğŸ”¸ {metal2}: {elements[metal2]}")

# -----------------------------
# í•©ê¸ˆ ê³„ì‚° í•¨ìˆ˜
# -----------------------------
def calc_properties(m1, r1, m2, r2):
    # ê¸°ë³¸ ì ìˆ˜ (0~1)
    score = {
        "ğŸ’ª ê°•ë„":0,
        "ğŸ›¡ï¸ ë‚´ì‹ì„±":0,
        "âš–ï¸ ê°€ë²¼ì›€":0
    }

    factor = {
        "ì² (Fe)":{"strength":0.6,"corrosion":0.2,"weight":0.2},
        "íƒ„ì†Œ(C)":{"strength":0.3,"corrosion":0.1,"weight":0.3},
        "ì•Œë£¨ë¯¸ëŠ„(Al)":{"strength":0.4,"corrosion":0.5,"weight":0.7},
        "êµ¬ë¦¬(Cu)":{"strength":0.3,"corrosion":0.4,"weight":0.3},
        "ë‹ˆì¼ˆ(Ni)":{"strength":0.5,"corrosion":0.6,"weight":0.3}
    }

    # ë¹„ìœ¨ ë°˜ì˜
    total = r1 + r2
    score["ğŸ’ª ê°•ë„"] = (factor[m1]["strength"]*r1 + factor[m2]["strength"]*r2)/total*100
    score["ğŸ›¡ï¸ ë‚´ì‹ì„±"] = (factor[m1]["corrosion"]*r1 + factor[m2]["corrosion"]*r2)/total*100
    score["âš–ï¸ ê°€ë²¼ì›€"] = (factor[m1]["weight"]*r1 + factor[m2]["weight"]*r2)/total*100

    return score

# -----------------------------
# í•©ê¸ˆ í™œìš© ë¶„ì•¼ ì¶”ì²œ í•¨ìˆ˜
# -----------------------------
def suggest_application(scores):
    applications = []
    if scores["ğŸ’ª ê°•ë„"] > 60 and scores["âš–ï¸ ê°€ë²¼ì›€"] > 50:
        applications.append("ğŸš€ í•­ê³µ/ìë™ì°¨ìš© ê²½ëŸ‰ ê³ ê°•ë„ í•©ê¸ˆ")
    if scores["ğŸ›¡ï¸ ë‚´ì‹ì„±"] > 60:
        applications.append("ğŸ›¡ï¸ ë‚´ì‹ì„±ì´ ì¤‘ìš”í•œ ì„ ë°•, í™”í•™ ì¥ë¹„")
    if scores["ğŸ’ª ê°•ë„"] > 50 and scores["ğŸ›¡ï¸ ë‚´ì‹ì„±"] > 50:
        applications.append("ğŸ—ï¸ ê±´ì¶• êµ¬ì¡°ì¬, ì‚°ì—… ê¸°ê³„ìš© í•©ê¸ˆ")
    if not applications:
        applications.append("ğŸ”¹ ì¼ë°˜ í•©ê¸ˆ, ì‹¤í—˜ì„ í†µí•´ ìµœì  ì¡°í•© íƒìƒ‰")
    return applications

# -----------------------------
# í•©ê³„ ì²´í¬ ë° ê²°ê³¼ ì¶œë ¥
# -----------------------------
if ratio1 + ratio2 != 100:
    st.warning("âš ï¸ ë¹„ìœ¨ í•©ê³„ê°€ 100%ê°€ ë˜ë„ë¡ ì¡°ì •í•´ì£¼ì„¸ìš”!")
else:
    st.success("âœ… ë¹„ìœ¨ í•©ê³„ 100%")
    scores = calc_properties(metal1, ratio1, metal2, ratio2)

    st.subheader("ğŸ“Š í•©ê¸ˆ ì˜ˆì¸¡ ê²°ê³¼")
    st.write(f"ğŸ”¹ í•©ê¸ˆ ì¡°í•©: {metal1} {ratio1}% + {metal2} {ratio2}%")
    st.write(f"ğŸ’ª ê°•ë„: {scores['ğŸ’ª ê°•ë„']:.1f} / 100")
    st.write(f"ğŸ›¡ï¸ ë‚´ì‹ì„±: {scores['ğŸ›¡ï¸ ë‚´ì‹ì„±']:.1f} / 100")
    st.write(f"âš–ï¸ ê°€ë²¼ì›€: {scores['âš–ï¸ ê°€ë²¼ì›€']:.1f} / 100")

    # -----------------------------
    # Streamlit ë‚´ì¥ ê·¸ë˜í”„ ì‚¬ìš©
    # -----------------------------
    st.subheader("ğŸ“ˆ íŠ¹ì„± ê·¸ë˜í”„")
    st.bar_chart(list(scores.values()), height=300)

    # -----------------------------
    # í™œìš© ë¶„ì•¼ í‘œì‹œ
    # -----------------------------
    st.subheader("ğŸ­ ì¶”ì²œ í™œìš© ë¶„ì•¼")
    apps = suggest_application(scores)
    for app in apps:
        st.write(app)
